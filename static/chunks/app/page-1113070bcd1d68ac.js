(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9013:function(e,t,r){Promise.resolve().then(r.bind(r,157))},551:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let n=r(1609);r(7437),r(2265);let a=n._(r(148));function l(e,t){var r;let n={loading:e=>{let{error:t,isLoading:r,pastDelay:n}=e;return null}};"function"==typeof e&&(n.loader=e);let l={...n,...t};return(0,a.default)({...l,modules:null==(r=l.loadableGenerated)?void 0:r.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},912:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let n=r(5592);function a(e){let{reason:t,children:r}=e;if("undefined"==typeof window)throw new n.BailoutToCSRError(t);return r}},148:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let n=r(7437),a=r(2265),l=r(912),s=r(1481);function o(e){return{default:e&&"default"in e?e.default:e}}let d={loader:()=>Promise.resolve(o(()=>null)),loading:null,ssr:!0},c=function(e){let t={...d,...e},r=(0,a.lazy)(()=>t.loader().then(o)),c=t.loading;function i(e){let o=c?(0,n.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,d=t.ssr?(0,n.jsxs)(n.Fragment,{children:["undefined"==typeof window?(0,n.jsx)(s.PreloadCss,{moduleIds:t.modules}):null,(0,n.jsx)(r,{...e})]}):(0,n.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(r,{...e})});return(0,n.jsx)(a.Suspense,{fallback:o,children:d})}return i.displayName="LoadableComponent",i}},1481:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return l}});let n=r(7437),a=r(8512);function l(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let r=(0,a.getExpectedRequestStore)("next/dynamic css"),l=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files.filter(e=>e.endsWith(".css"));l.push(...t)}}return 0===l.length?null:(0,n.jsx)(n.Fragment,{children:l.map(e=>(0,n.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:r.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},157:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var n=r(7437),a=r(2265),l=r(551),s=r.n(l),o=r(718),d=r(4624);let c=[{type:"impl",name:"HelloStarknetImpl",interface_name:"workshop_frontend::IHelloStarknet"},{type:"struct",name:"core::integer::u256",members:[{name:"low",type:"core::integer::u128"},{name:"high",type:"core::integer::u128"}]},{type:"interface",name:"workshop_frontend::IHelloStarknet",items:[{type:"function",name:"increase_balance",inputs:[{name:"amount",type:"core::integer::u256"}],outputs:[],state_mutability:"external"},{type:"function",name:"get_balance",inputs:[],outputs:[{type:"core::integer::u256"}],state_mutability:"view"},{type:"function",name:"reset_balance",inputs:[],outputs:[],state_mutability:"external"}]},{type:"event",name:"workshop_frontend::HelloStarknet::BalanceIncreased",kind:"struct",members:[{name:"sender",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"amount",type:"core::integer::u256",kind:"data"},{name:"new_balance",type:"core::integer::u256",kind:"data"}]},{type:"event",name:"workshop_frontend::HelloStarknet::Event",kind:"enum",variants:[{name:"BalanceIncreased",type:"workshop_frontend::HelloStarknet::BalanceIncreased",kind:"nested"}]}],i=e=>"".concat(e.slice(0,6),"...").concat(e.slice(-4)),u=e=>parseInt(e,16).toString();var b=r(9767);let m=s()(()=>r.e(420).then(r.bind(r,9420)),{loadableGenerated:{webpack:()=>[9420]},ssr:!1});var h=()=>{let{data:e,isLoading:t,isError:r}=(0,o.Ov)({blockIdentifier:"latest"}),{address:l}=(0,o.mA)(),{isLoading:s,isError:h,error:f,data:p}=(0,o.KQ)({address:l,watch:!0}),x="0x1c758616421a10f9df071a5d985c72e3907cf98d553204cf8dee354647c736",{data:g,refetch:y,isError:j,isLoading:k,error:v}=(0,o.uT)({functionName:"get_balance",args:[],abi:c,address:x,watch:!0,refetchInterval:1e3}),[w,_]=(0,a.useState)(0),N=async e=>{e.preventDefault(),console.log("Form submitted with amount ",w),P()},{contract:S}=(0,o.cq)({abi:c,address:x}),C=(0,a.useMemo)(()=>{if(!l||!S)return[];let e=w||0;return[S.populate("increase_balance",[e])]},[S,l,w]),{send:P,data:B,isPending:E}=(0,o.pQ)({calls:C}),{data:O,status:I,isLoading:M,isError:R,error:L}=(0,o.VS)({hash:null==B?void 0:B.transaction_hash,watch:!0}),T=e=>{let{message:t}=e;return(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"animate-spin",children:(0,n.jsx)("svg",{className:"h-5 w-5 text-gray-800",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),(0,n.jsx)("span",{children:t})]})},W=(0,a.useMemo)(()=>{if(S)try{return S.populate("reset_balance")}catch(e){console.error("Error populating reset_balance call:",e);return}},[S]),{send:H,isPending:F,data:A}=(0,o.pQ)({calls:W?[W]:[]}),U=(0,a.useMemo)(()=>new d.Gf({nodeUrl:b.env.NEXT_PUBLIC_RPC_URL}),[]),[G,Q]=(0,a.useState)([]),q=(0,a.useRef)(0),{data:z}=(0,o.Ov)({refetchInterval:3e3}),D=(0,a.useCallback)(async(e,t)=>{if(!(t<=q.current))try{let r=q.current+1,n=await U.getEvents({address:e.address,from_block:{block_number:r},to_block:{block_number:t},chunk_size:500});n&&n.events&&Q(e=>[...e,...n.events]),q.current=t}catch(e){console.error("Error checking for events:",e)}},[U]);(0,a.useEffect)(()=>{S&&z&&D(S,z)},[S,z,D]);let X=(0,a.useMemo)(()=>[...G].reverse().slice(0,5),[G]);return(0,n.jsxs)("div",{className:"min-h-screen bg-gray-100 p-4 flex flex-col",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-center mb-6",children:"Starknet Frontend Workshop"}),(0,n.jsxs)("div",{className:"flex flex-wrap justify-center gap-4",children:[(0,n.jsxs)("div",{className:"w-full max-w-md space-y-4",children:[(0,n.jsxs)("div",{className:"bg-white p-4 border-black border",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Wallet Connection"}),(0,n.jsx)(m,{})]}),!t&&!r&&(0,n.jsxs)("div",{className:"p-4 border-black border ".concat(e<18e4?"bg-green-500":"bg-red-500"),children:[(0,n.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Read the Blockchain"}),(0,n.jsxs)("p",{children:["Current Block: ",e]}),(0,n.jsx)("p",{children:e<18e4?"Workshop is live":"Workshop has ended"})]}),!s&&!h&&l&&(0,n.jsxs)("div",{className:"p-4 bg-white border-black border",children:[(0,n.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Your Balance"}),(0,n.jsxs)("p",{children:["Symbol: ",null==p?void 0:p.symbol]}),(0,n.jsxs)("p",{children:["Balance: ",Number(null==p?void 0:p.formatted).toFixed(4)]})]}),(0,n.jsxs)("div",{className:"p-4 bg-white border-black border",children:[(0,n.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Reset Balance"}),(0,n.jsx)("button",{onClick:()=>H(),disabled:F||!W||!l,className:"mt-2 border border-black text-black font-regular py-2 px-4 bg-yellow-300 hover:bg-yellow-500 disabled:bg-gray-300 disabled:cursor-not-allowed",children:F?(0,n.jsx)(T,{message:"Resetting..."}):"Reset Balance"}),(null==A?void 0:A.transaction_hash)&&(0,n.jsxs)("p",{className:"mt-2 text-sm",children:["Transaction sent: ",A.transaction_hash]})]})]}),(0,n.jsxs)("div",{className:"w-full max-w-md space-y-4",children:[(0,n.jsxs)("div",{className:"p-4 bg-white border-black border",children:[(0,n.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Contract Balance"}),(0,n.jsxs)("p",{children:["Balance: ",null==g?void 0:g.toString()]}),(0,n.jsx)("button",{onClick:()=>y(),className:"mt-2 border border-black text-black font-regular py-1 px-3 bg-yellow-300 hover:bg-yellow-500",children:"Refresh"})]}),(0,n.jsxs)("form",{onSubmit:N,className:"bg-white p-4 border-black border",children:[(0,n.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Write to Contract"}),(0,n.jsx)("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700",children:"Amount:"}),(0,n.jsx)("input",{type:"number",id:"amount",value:w,onChange:e=>{let t=e.target.value;_(""===t?"":Number(t))},className:"block w-full px-3 py-2 text-sm leading-6 border-black focus:outline-none focus:border-yellow-300 black-border-p"}),(0,n.jsx)("button",{type:"submit",className:"mt-3 border border-black text-black font-regular py-2 px-4 bg-yellow-300 hover:bg-yellow-500 disabled:bg-gray-300 disabled:cursor-not-allowed",disabled:!l||E,children:E?(0,n.jsx)(T,{message:"Send..."}):M?(0,n.jsx)(T,{message:"Waiting for confirmation..."}):"error"===I?(0,n.jsx)(T,{message:"Transaction rejected..."}):"success"===I?"Transaction confirmed":"Send"}),(null==B?void 0:B.transaction_hash)&&(0,n.jsx)("a",{href:"https://sepolia.voyager.online/tx/".concat(null==B?void 0:B.transaction_hash),target:"_blank",className:"block mt-2 text-blue-500 hover:text-blue-700 underline",rel:"noreferrer",children:"Check TX on Sepolia"})]}),(0,n.jsxs)("div",{className:"p-4 bg-white border-black border",children:[(0,n.jsxs)("h3",{className:"text-lg font-bold mb-2",children:["Contract Events (",G.length,")"]}),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full border-collapse",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"border-b border-gray-300 text-left p-2 font-semibold",children:"Sender"}),(0,n.jsx)("th",{className:"border-b border-gray-300 text-right p-2 font-semibold",children:"Added"}),(0,n.jsx)("th",{className:"border-b border-gray-300 text-right p-2 font-semibold",children:"New Balance"})]})}),(0,n.jsx)("tbody",{children:X.map((e,t)=>(0,n.jsxs)("tr",{className:t%2==0?"bg-gray-50":"",children:[(0,n.jsx)("td",{className:"border-b border-gray-200 p-2",children:i(e.keys[1])}),(0,n.jsx)("td",{className:"border-b border-gray-200 p-2 text-right",children:u(e.data[0])}),(0,n.jsx)("td",{className:"border-b border-gray-200 p-2 text-right",children:u(e.data[2])})]},t))})]})})]})]})]})]})}}},function(e){e.O(0,[255,125,357,971,23,744],function(){return e(e.s=9013)}),_N_E=e.O()}]);